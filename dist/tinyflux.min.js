!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("Immutable")):"function"==typeof define&&define.amd?define(["Immutable"],e):"object"==typeof exports?exports.TinyFlux=e(require("Immutable")):t.TinyFlux=e(t.Immutable)}(this,function(t){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function n(t,e){if(t===e||s(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(var i=Object.prototype.hasOwnProperty.bind(e),o=0;o<r.length;o++)if(!i(r[o])||!s(t[r[o]],e[r[o]]))return!1;return!0}function i(t){function e(){this._listeners=new Set,this.initialize&&this.initialize(),this._data=this.get()}t.on=function(t){this._listeners.add(t)},t.off=function(t){this._listeners.delete(t)},t.trigger=function(){var t=this.get();if(!s(t,this._data)){this._data=t;var e=!0,r=!1,n=void 0;try{for(var i,o=this._listeners[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;a(t)}}catch(u){r=!0,n=u}finally{try{!e&&o.return&&o.return()}finally{if(r)throw n}}}},t.connect=function(t,e){var r=this,n=function(t){r[e]=t,r.trigger()};t.on(n),this[e]=t.get()},t.connectFilter=function(t,e,r){var n=this,i=function(t){n[e]=r(t),n.trigger()};t.on(i),this[e]=r(t.get())},t._get=function(){return this._data},e.prototype=t;var r=new e,n={};n.on=r.on.bind(r),n.off=r.off.bind(r),n.get=r._get.bind(r);for(var i in r){var o=r[i];if("function"==typeof o&&"on"==i.substr(0,2)&&0!=i.substr(2).length){var a=i.substr(2,1).toLowerCase()+i.substr(3);n[a]=o.bind(r)}}return n}var o=r(1),s=o.is.bind(o),a={getInitialState:function(){this._stores=[],this.initialize&&this.initialize();var t={},e=!0,r=!1,n=void 0;try{for(var i,o=this._stores[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var s=i.value,a=s.stateName,u=s.store.get();s.filter&&(u=s.filter(u)),t[a]=u}}catch(f){r=!0,n=f}finally{try{!e&&o.return&&o.return()}finally{if(r)throw n}}return t},connect:function(t,e){var r=this,n=function(t){var n={};n[e]=t,r.setState(n)};t.on(n),this._stores.push({store:t,trigger:n,stateName:e})},connectFilter:function(t,e,r){var n=this,i=function(t){var i={};i[e]=r(t),n.setState(i)};t.on(i),this._stores.push({store:t,trigger:i,stateName:e,filter:r})},shouldComponentUpdate:function(t,e){return!n(this.props,t)||!n(this.state,e)},componentWillUnmount:function(){var t=!0,e=!1,r=void 0;try{for(var n,i=this._stores[Symbol.iterator]();!(t=(n=i.next()).done);t=!0){var o=n.value;o.store.off(o.trigger)}}catch(s){e=!0,r=s}finally{try{!t&&i.return&&i.return()}finally{if(e)throw r}}this._stores=null}};t.exports={createStore:i,ComponentMixin:a}},function(e,r){e.exports=t}])});